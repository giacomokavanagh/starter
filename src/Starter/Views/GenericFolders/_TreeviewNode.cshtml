@model GenericFolderTreeNode

@if (Model.GenericFolders.Where(s => s.ParentLocationID == Model.Seed).Any())
{
    
    @foreach (var node in Model.GenericFolders)
    {
        if (node.ParentLocationID == Model.Seed)
        {
            var inner = new GenericFolderTreeNode { Seed = node.GenericFolderID, GenericFolders = Model.GenericFolders };

            if (!inner.GenericFolders.Where(t => t.ParentLocationID == inner.Seed).Any())
            {
                <div class='treeview panel-group'>
                    <div class='treeview panel panel-default'>
                        <div class='treeview panel-heading'>
                            <a class="treeviewLink" asp-controller="GenericFolders" asp-action="Details" asp-route-id="@node.GenericFolderID" name="@node.GenericFolderID">@node.Name</a>
                        </div>
                    </div>
                </div>
            }
            else
            {
                var toggleID = "collapseFolders" + node.GenericFolderID;
                string classExpandedOrNot;
                if(node.isExpanded)
                {
                    classExpandedOrNot = "collapse in";
                }
                else
                {
                    classExpandedOrNot = "collapse";
                }

                <div class='treeview panel-group'>
                    <div class='treeview panel panel-default'>
                        <div class='treeview panel-heading'>
                            <a class="treeview" data-toggle='collapse' id='Toggle' href='#@toggleID' name="@node.GenericFolderID">@node.Name</a>
                        </div>


                        <div id='@toggleID' class='treeview panel-collapse collapsed @classExpandedOrNot' name="@node.GenericFolderID">
                            <div class='treeview panel-body' name="@node.GenericFolderID">

                                @Html.Partial("_TreeviewNode", inner)

                            </div>
                        </div>
                    </div>
                </div>
            }
        }
    }
}
